~Some code optimizations.
Note: This is final update :(
